{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "819005df_c88828f5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 6639
      },
      "writtenOn": "2024-05-23T09:59:14Z",
      "side": 1,
      "message": "teh code does have soem bits we need but teh strycture is wrong at a high level.\nTeh AC for this usre storiy mentioend to agrre a Prposla befoer we start code, I thinkthi review shows taht was teh correct approach. So please do a moe detailed proposal (e.g. some pseudo code) first, I can help you get started with that",
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c8b2d2d6_971b5116",
        "filename": "cps-ncmp-service/src/main/java/org/onap/cps/ncmp/api/impl/DataJobServiceImpl.java",
        "patchSetId": 11
      },
      "lineNbr": 29,
      "author": {
        "id": 6639
      },
      "writtenOn": "2024-05-22T15:57:51Z",
      "side": 1,
      "message": "should be in API\npossibly in api.models, we might nee a bit of team a discussion this\n(this same comment applies to quiet a few data objects)\nlter thought: i think models is realy just for REST models",
      "range": {
        "startLine": 29,
        "startChar": 29,
        "endLine": 29,
        "endChar": 33
      },
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fafd6339_0c3b4f21",
        "filename": "cps-ncmp-service/src/main/java/org/onap/cps/ncmp/api/impl/DataJobServiceImpl.java",
        "patchSetId": 11
      },
      "lineNbr": 30,
      "author": {
        "id": 6639
      },
      "writtenOn": "2024-05-22T15:57:51Z",
      "side": 1,
      "message": "should be in API",
      "range": {
        "startLine": 30,
        "startChar": 29,
        "endLine": 30,
        "endChar": 33
      },
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9191c165_1fd24806",
        "filename": "cps-ncmp-service/src/main/java/org/onap/cps/ncmp/api/impl/DataJobServiceImpl.java",
        "patchSetId": 11
      },
      "lineNbr": 32,
      "author": {
        "id": 6639
      },
      "writtenOn": "2024-05-22T15:57:51Z",
      "side": 1,
      "message": "should be in API",
      "range": {
        "startLine": 32,
        "startChar": 29,
        "endLine": 32,
        "endChar": 33
      },
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9883eecc_8731fc48",
        "filename": "cps-ncmp-service/src/main/java/org/onap/cps/ncmp/api/impl/DataJobServiceImpl.java",
        "patchSetId": 11
      },
      "lineNbr": 62,
      "author": {
        "id": 7957
      },
      "writtenOn": "2024-05-22T15:42:22Z",
      "side": 1,
      "message": "if (dataJobWriteRequest.data().isEmpty()) {\n        log.info(\"Data job request is empty for data job id: {}.\", dataJobId);\n        return;\n    }",
      "range": {
        "startLine": 62,
        "startChar": 7,
        "endLine": 62,
        "endChar": 52
      },
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9b98268a_b89f8e5f",
        "filename": "cps-ncmp-service/src/main/java/org/onap/cps/ncmp/api/impl/DataJobServiceImpl.java",
        "patchSetId": 11
      },
      "lineNbr": 62,
      "author": {
        "id": 6639
      },
      "writtenOn": "2024-05-23T09:59:14Z",
      "side": 1,
      "message": "I am not sure if we even need to handle this case (now)... Its an edge case lets focus on happy path now. I think we need/have separate user stories for erro handling and error cases this is a good eample for that. And thsi shoudl even be doen at teh requiremtn level so we need to agree with stakehodlers about this\n\nfor now I would NOT check this to avoid tets complications...",
      "parentUuid": "9883eecc_8731fc48",
      "range": {
        "startLine": 62,
        "startChar": 7,
        "endLine": 62,
        "endChar": 52
      },
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8cdb14aa_ba8c6a5d",
        "filename": "cps-ncmp-service/src/main/java/org/onap/cps/ncmp/api/impl/DataJobServiceImpl.java",
        "patchSetId": 11
      },
      "lineNbr": 62,
      "author": {
        "id": 7957
      },
      "writtenOn": "2024-05-23T11:06:25Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "9b98268a_b89f8e5f",
      "range": {
        "startLine": 62,
        "startChar": 7,
        "endLine": 62,
        "endChar": 52
      },
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7caf4a38_fb8ea601",
        "filename": "cps-ncmp-service/src/main/java/org/onap/cps/ncmp/api/impl/DataJobServiceImpl.java",
        "patchSetId": 11
      },
      "lineNbr": 64,
      "author": {
        "id": 7957
      },
      "writtenOn": "2024-05-22T15:42:22Z",
      "side": 1,
      "message": "create global constant FIRST_JOB",
      "range": {
        "startLine": 64,
        "startChar": 81,
        "endLine": 64,
        "endChar": 82
      },
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "72508353_803bf53d",
        "filename": "cps-ncmp-service/src/main/java/org/onap/cps/ncmp/api/impl/DataJobServiceImpl.java",
        "patchSetId": 11
      },
      "lineNbr": 81,
      "author": {
        "id": 7957
      },
      "writtenOn": "2024-05-22T15:42:22Z",
      "side": 1,
      "message": "Yes Gerard  here we should make use of DmiServiceUrlBuilder",
      "range": {
        "startLine": 81,
        "startChar": 42,
        "endLine": 81,
        "endChar": 90
      },
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e1ad775b_13c03706",
        "filename": "cps-ncmp-service/src/main/java/org/onap/cps/ncmp/api/impl/DataJobServiceImpl.java",
        "patchSetId": 11
      },
      "lineNbr": 83,
      "author": {
        "id": 7957
      },
      "writtenOn": "2024-05-22T15:42:22Z",
      "side": 1,
      "message": "create global constant NO_AUTH_HEADER",
      "range": {
        "startLine": 83,
        "startChar": 46,
        "endLine": 83,
        "endChar": 50
      },
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8d061457_91577831",
        "filename": "cps-ncmp-service/src/main/java/org/onap/cps/ncmp/api/impl/DataJobServiceImpl.java",
        "patchSetId": 11
      },
      "lineNbr": 86,
      "author": {
        "id": 7957
      },
      "writtenOn": "2024-05-22T15:42:22Z",
      "side": 1,
      "message": "log.info(\"Starting write operation for data job id: {}\", dataJobId);\n\n    final WriteOperation writeOperation \u003d dataJobWriteRequest.data().get(FIRST_JOB);\n\n        final DataNode dataNode \u003d fetchDataNode(writeOperation.path());\n        final SubJobWriteRequest subJobWriteRequest \u003d createSubJobWriteRequest(dataJobMetadata, dataJobId, writeOperation, dataNode);\n        postWriteOperation(dataJobId, subJobWriteRequest);\n    }\n    \n    \n    private DataNode fetchDataNode(String path) {\n    try {\n        return inventoryPersistence.getCmHandleDataNodeByLongestMatchAlternateId(path, SEPARATOR);\n    } catch (Exception e) {\n        log.error(\"Error fetching DataNode for path: {}\", path, e.getMessage());\n    }\n}\n\n\n\nprivate SubJobWriteRequest createSubJobWriteRequest(final DataJobMetadata dataJobMetadata, final String dataJobId,\n                                                    final WriteOperation writeOperation, final DataNode dataNode) {\n    SubJobWriteRequest subJobWriteRequest \u003d new SubJobWriteRequest();\n    subJobWriteRequest.setDataContentType(dataJobMetadata.dataContentType());\n    subJobWriteRequest.setDataAcceptType(dataJobMetadata.dataAcceptType());\n    subJobWriteRequest.setDataProducerId(dataJobId);\n\n    Dmi3ggpWriteOperation dmiWriteOperation \u003d new Dmi3ggpWriteOperation();\n    dmiWriteOperation.setOp(writeOperation.op());\n    dmiWriteOperation.setOperationId(Integer.valueOf(writeOperation.operationId()));\n    dmiWriteOperation.setModuleSetTag((String) dataNode.getLeaves().get(\"module-set-tag\"));\n    dmiWriteOperation.setPath(writeOperation.path());\n    dmiWriteOperation.setPrivateProperties(getPrivatePropertiesFromDataNode(dataNode));\n\n    subJobWriteRequest.getData().add(dmiWriteOperation);\n\n    return subJobWriteRequest;\n}\n\n\n\nprivate void postWriteOperation(final String dataJobId, final SubJobWriteRequest subJobWriteRequest) {\n    try {\n        final String dmiResourceUrl \u003d make use of DmiServiceUrlBuilder class;\n        dmiRestClient.postOperationWithJsonData(dmiResourceUrl, jsonObjectMapper.asJsonString(subJobWriteRequest),\n                OperationType.CREATE, NO_AUTH_HEADER);\n        log.info(\"Successfully posted write operation for data job id: {}\", dataJobId);\n    } catch (Exception e) {\n        log.error(\"Error posting write operation for data job id: {}\", dataJobId, e);\n        throw e; // Re-throw to indicate failure\n    }\n}",
      "range": {
        "startLine": 63,
        "startChar": 9,
        "endLine": 86,
        "endChar": 9
      },
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d72a6b3d_49acb2a5",
        "filename": "cps-ncmp-service/src/main/java/org/onap/cps/ncmp/api/impl/datajob/Dmi3ggpWriteOperation.java",
        "patchSetId": 11
      },
      "lineNbr": 26,
      "author": {
        "id": 7957
      },
      "writtenOn": "2024-05-22T15:42:22Z",
      "side": 1,
      "message": "Use record here as below:\n\norg/onap/cps/ncmp/api/models/datajob/DataJobMetadata.java:33",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 26,
        "endChar": 5
      },
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3380f51a_f6e85b80",
        "filename": "cps-ncmp-service/src/main/java/org/onap/cps/ncmp/api/impl/datajob/SubJobWriteRequest.java",
        "patchSetId": 11
      },
      "lineNbr": 21,
      "author": {
        "id": 6639
      },
      "writtenOn": "2024-05-22T15:57:51Z",
      "side": 1,
      "message": "we need to be careful what goes in the API and what in the IMPL. Anything that the client will need to call the interface will need to go onto the API folder\nWe have broken this rul a bit already in legacy code but lets do it correct here as we will have a different team using this API and NOT the impl...",
      "range": {
        "startLine": 21,
        "startChar": 26,
        "endLine": 21,
        "endChar": 34
      },
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a0b9345f_dc6dcfc5",
        "filename": "cps-ncmp-service/src/main/java/org/onap/cps/ncmp/api/impl/datajob/SubJobWriteRequest.java",
        "patchSetId": 11
      },
      "lineNbr": 27,
      "author": {
        "id": 7957
      },
      "writtenOn": "2024-05-22T15:42:22Z",
      "side": 1,
      "message": "Use record here as below:\n\norg/onap/cps/ncmp/api/models/datajob/DataJobMetadata.java:33",
      "range": {
        "startLine": 27,
        "startChar": 0,
        "endLine": 27,
        "endChar": 5
      },
      "revId": "19afa3de40ad407df9d127a355936ea3c0faf326",
      "serverId": "14b4e41f-c4e3-4fb9-9955-6a9b5656895a"
    }
  ]
}